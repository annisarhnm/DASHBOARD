---
title: "Uji Proporsi dan Varians"
output:
  pdf_document: 
    latex_engine: pdflatex
    keep_tex: false
  word_document: default
params:
  title: NA
  test_output: NA
  interpretation_text: NA
  plot_path: NA
  var_info: NA
---

```{r setup, include=FALSE}
# Set library path
.libPaths(c("~/R/library", .libPaths()))

# Load required packages
suppressMessages({
  library(knitr)
  library(rmarkdown)
})

# Set knitr options
knitr::opts_chunk$set(echo=FALSE, warning=FALSE, message=FALSE)
```

## `r params$title`

```{r, results='asis'}
if (!is.null(params$var_info) && params$var_info != "") {
  cat("### Informasi Variabel\n\n")
  cat(params$var_info)
  cat("\n\n")
}
```

### Hasil Uji

```{r, comment=''}
if (!is.null(params$test_output) && length(params$test_output) > 0) {
  if (is.character(params$test_output)) {
    cat(paste(params$test_output, collapse="\n"))
  } else {
    cat(capture.output(print(params$test_output)), sep="\n")
  }
}
```

```{r, eval=!is.null(params$plot_path) && params$plot_path != "" && file.exists(params$plot_path)}
if (!is.null(params$plot_path) && params$plot_path != "" && file.exists(params$plot_path)) {
  knitr::include_graphics(params$plot_path)
}
```

### Interpretasi

```{r, results='asis'}
if (!is.null(params$interpretation_text) && params$interpretation_text != "") {
  # Clean up HTML tags if present
  interp_text <- gsub("<[^>]*>", "", params$interpretation_text)
  interp_text <- gsub("&nbsp;", " ", interp_text)
  interp_text <- gsub("&lt;", "<", interp_text)
  interp_text <- gsub("&gt;", ">", interp_text)
  cat(interp_text)
}
```
